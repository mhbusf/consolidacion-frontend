<div class="container mt-4">
  <h2 class="mb-4">üìä Dashboard de Seguimiento</h2>

  <!-- Loading -->
  <div *ngIf="loading" class="text-center my-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Cargando...</span>
    </div>
    <p class="mt-2">Cargando dashboard...</p>
  </div>

  <!-- Error -->
  <div *ngIf="error" class="alert alert-danger">
    <strong>‚ö†Ô∏è Error:</strong> {{ error }}
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="dashboard && !loading">
    
    <!-- Tarjetas de resumen - Fila 1 -->
    <div class="row g-3 mb-4">
      <div class="col-md-3">
        <div class="card text-center h-100 border-0 shadow-sm">
          <div class="card-body bg-primary text-white rounded">
            <h3 class="display-4 fw-bold">{{ dashboard.totalConsolidados }}</h3>
            <p class="mb-0">Total Consolidados</p>
          </div>
        </div>
      </div>
      
      <div class="col-md-3">
        <div class="card text-center h-100 border-0 shadow-sm">
          <div class="card-body bg-info text-white rounded">
            <h3 class="display-4 fw-bold">{{ dashboard.consolidadosEnProceso }}</h3>
            <p class="mb-0">En Proceso</p>
          </div>
        </div>
      </div>
      
      <div class="col-md-3">
        <div class="card text-center h-100 border-0 shadow-sm">
          <div class="card-body bg-success text-white rounded">
            <h3 class="display-4 fw-bold">{{ dashboard.consolidadosAlDia }}</h3>
            <p class="mb-0">‚úÖ Al D√≠a</p>
          </div>
        </div>
      </div>
      
      <div class="col-md-3">
        <div class="card text-center h-100 border-0 shadow-sm">
          <div class="card-body bg-danger text-white rounded">
            <h3 class="display-4 fw-bold">{{ dashboard.consolidadosAtrasados }}</h3>
            <p class="mb-0">‚ö†Ô∏è Con Atrasos</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Tarjetas de resumen - Fila 2 -->
    <div class="row g-3 mb-4">
      <div class="col-md-6">
        <div class="card text-center h-100 border-0 shadow-sm">
          <div class="card-body">
            <h3 class="display-4 fw-bold text-success">{{ dashboard.consolidadosConGDC }}</h3>
            <p class="mb-0">Con GDC Asignado</p>
          </div>
        </div>
      </div>
      
      <div class="col-md-6">
        <div class="card text-center h-100 border-0 shadow-sm">
          <div class="card-body">
            <h3 class="display-4 fw-bold text-secondary">{{ dashboard.consolidadosCerrados }}</h3>
            <p class="mb-0">Cerrados</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Tabla de consolidados con atrasos -->
    <div class="card shadow-sm border-0" *ngIf="dashboard.consolidadosConAtrasos && dashboard.consolidadosConAtrasos.length > 0">
      <div class="card-header bg-danger text-white">
        <h4 class="mb-0">‚ö†Ô∏è Consolidados con Comentarios Atrasados</h4>
      </div>
      <div class="card-body p-0">
        <div class="table-responsive">
          <table class="table table-hover mb-0">
            <thead class="table-light">
              <tr>
                <th>Nombre</th>
                <th>Asignado a</th>
                <th>Estado</th>
                <th>Fecha Ingreso</th>
                <th>Comentarios Pendientes</th>
                <th class="text-center">D√≠as Atraso</th>
                <th class="text-center">Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let consol of dashboard.consolidadosConAtrasos">
                <td class="fw-bold">{{ consol.titulo }}</td>
                <td>{{ consol.asignadoA }}</td>
                <td>
                  <span class="badge" [ngClass]="getEstadoClass(consol.estado)">
                    {{ consol.estado }}
                  </span>
                </td>
                <td>{{ consol.fechaIngreso | date: 'dd/MM/yyyy' }}</td>
                <td>
                  <ul class="list-unstyled mb-0 small">
                    <li *ngFor="let pendiente of consol.comentariosPendientes" class="mb-1">
                      <strong>{{ pendiente.tipo }}:</strong>
                      <span [ngClass]="getAtrasoClass(pendiente.diasDeAtraso)">
                        {{ pendiente.diasDeAtraso }} d√≠a<span *ngIf="pendiente.diasDeAtraso !== 1">s</span> de atraso
                      </span>
                    </li>
                  </ul>
                </td>
                <td class="text-center">
                  <span class="badge bg-danger fs-6">
                    {{ consol.diasDeAtraso }} d√≠a<span *ngIf="consol.diasDeAtraso !== 1">s</span>
                  </span>
                </td>
                <td class="text-center">
                  <button class="btn btn-sm btn-primary" (click)="verConsolidado(consol.id)">
                    <i class="bi bi-eye"></i> Ver Detalle
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Mensaje si no hay atrasos -->
    <div class="alert alert-success shadow-sm" *ngIf="!dashboard.consolidadosConAtrasos || dashboard.consolidadosConAtrasos.length === 0">
      <h5 class="alert-heading">‚úÖ