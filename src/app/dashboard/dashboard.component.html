<div class="dashboard-container">
  <h2 class="dashboard-title">üìä Dashboard de Seguimiento</h2>

  <!-- Loading -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Cargando dashboard...</p>
  </div>

  <!-- Error -->
  <div *ngIf="error" class="alert alert-danger">
    <strong>‚ö†Ô∏è Error:</strong> {{ error }}
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="dashboard && !loading">
    
    <!-- Tarjetas principales con gradientes -->
    <div class="stats-grid">
      <div class="stat-card gradient-blue">
        <div class="stat-icon">üìã</div>
        <div class="stat-content">
          <div class="stat-number">{{ dashboard.totalConsolidados }}</div>
          <div class="stat-label">Total Consolidados</div>
        </div>
      </div>

      <div class="stat-card gradient-purple">
        <div class="stat-icon">üîÑ</div>
        <div class="stat-content">
          <div class="stat-number">{{ dashboard.consolidadosEnProceso }}</div>
          <div class="stat-label">En Proceso</div>
        </div>
      </div>

      <div class="stat-card gradient-green">
        <div class="stat-icon">‚úÖ</div>
        <div class="stat-content">
          <div class="stat-number">{{ dashboard.consolidadosAlDia }}</div>
          <div class="stat-label">Al D√≠a</div>
        </div>
      </div>

      <div class="stat-card gradient-red">
        <div class="stat-icon">‚ö†Ô∏è</div>
        <div class="stat-content">
          <div class="stat-number">{{ dashboard.consolidadosAtrasados }}</div>
          <div class="stat-label">Con Atrasos</div>
        </div>
      </div>
    </div>

    <!-- Segunda fila de estad√≠sticas -->
    <div class="stats-grid-secondary">
      <div class="stat-card gradient-teal">
        <div class="stat-icon">üìù</div>
        <div class="stat-content">
          <div class="stat-number">{{ dashboard.consolidadosConGDC }}</div>
          <div class="stat-label">Con GDC Asignado</div>
        </div>
      </div>

      <div class="stat-card gradient-gray">
        <div class="stat-icon">üîí</div>
        <div class="stat-content">
          <div class="stat-number">{{ dashboard.consolidadosCerrados }}</div>
          <div class="stat-label">Cerrados</div>
        </div>
      </div>
    </div>

    <!-- Tabla de consolidados con atrasos -->
    <div class="table-section" *ngIf="dashboard.consolidadosConAtrasos && dashboard.consolidadosConAtrasos.length > 0">
      <div class="section-header">
        <h3>‚ö†Ô∏è Consolidados con Comentarios Atrasados</h3>
        <span class="badge-count">{{ dashboard.consolidadosConAtrasos.length }}</span>
      </div>

      <div class="table-container">
        <table class="dashboard-table">
          <thead>
            <tr>
              <th>Nombre</th>
              <th>Asignado a</th>
              <th>Estado</th>
              <th>Fecha Ingreso</th>
              <th>Comentarios Pendientes</th>
              <th class="text-center">D√≠as Atraso</th>
              <th class="text-center">Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let consol of dashboard.consolidadosConAtrasos" class="table-row">
              <td class="fw-bold">{{ consol.titulo }}</td>
              <td>
                <span class="user-badge">{{ consol.asignadoA }}</span>
              </td>
              <td>
                <span class="badge" [ngClass]="getEstadoClass(consol.estado)">
                  {{ consol.estado }}
                </span>
              </td>
              <td>{{ consol.fechaIngreso | date: 'dd/MM/yyyy' }}</td>
              <td>
                <div class="pendientes-list">
                  <div *ngFor="let pendiente of consol.comentariosPendientes" class="pendiente-item">
                    <strong>{{ pendiente.tipo }}:</strong>
                    <span [ngClass]="getAtrasoClass(pendiente.diasDeAtraso)">
                      {{ pendiente.diasDeAtraso }} d√≠a<span *ngIf="pendiente.diasDeAtraso !== 1">s</span>
                    </span>
                  </div>
                </div>
              </td>
              <td class="text-center">
                <span class="badge-atraso" [ngClass]="getAtrasoClass(consol.diasDeAtraso)">
                  {{ consol.diasDeAtraso }} d√≠a<span *ngIf="consol.diasDeAtraso !== 1">s</span>
                </span>
              </td>
              <td class="text-center">
                <button class="btn-action" (click)="verConsolidado(consol.id)">
                  Ver Detalle ‚Üí
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Mensaje si no hay atrasos -->
    <div class="success-message" *ngIf="!dashboard.consolidadosConAtrasos || dashboard.consolidadosConAtrasos.length === 0">
      <div class="success-icon">üéâ</div>
      <h3>¬°Excelente trabajo!</h3>
      <p>Todos los consolidados est√°n al d√≠a con sus comentarios obligatorios.</p>
    </div>

  </div>
</div>